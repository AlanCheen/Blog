# 《透视 HTTP》

https://time.geekbang.org/column/article/97822



### 01 HTTP 前世今生





### 04 HTTP 世界全览（下）：与 HTTP有关 的各种协议

​	![img](http://ww1.sinaimg.cn/large/006tNc79ly1g5cizdal0nj30u010lqd1.jpg)

#### TCP/IP


TCP/IP 协议实际上是`一系列网络通信协议的统称`，其中最核心的两个协议是 **TCP** 和 **IP**，其他的还有 UDP、ICMP、ARP 等等，共同构成了一个复杂但有层次的协议栈。

这个协议栈有**四层**：

1. `应用层`，
2. `传输层`，TCP
3. `网际层`，IP

2. `链接层`，



##### IP

IP 协议（`I`nternet `P`rotocol），主要目的是解决`寻址`和`路由`的问题，以及`如何在两点间传输数据包`。

IP 协议用“IP地址”的概念来定位互联网上的每一台计算机。就像现在的电话号码、家庭地址。版本有 v4、v6 版本；v4 用四个“.”分隔的数字，比如“192.168.1.1”，v6 使用 8 组“:”分隔的数字作为地址。



##### TCP





#### DNS

域名系统（Domain Name System）





### 13 HTTP 有哪些特点？



### 23 HTTPS 是什么？SSL/TSL又是什么？

HTTP 缺点中包含了 `明文`、`不安全`。



通常认为，如果通信过程具备了四个特性， 就可以认为是“安全”的：`机密性`、`完整性`、`身份认证`和`不可否认`。



HTTPS，默认端口号 `443`。

HTTPS 把下层的`传输协议由 TCP/IP 换成了 SSL/TSL`，让 HTTP 运行在了安全的 SSL/TSL 协议上，收发报文`不再使用 Socket API`，而是`调用专门的安全接口`。（补充：实际上下面还是 TCP/IP）



![img](http://ww4.sinaimg.cn/large/006tNc79ly1g5ch9to2rxj31l50mi77u.jpg)

HTTPS 的语法、语义依然是 HTTP，它安全，其实全靠 SSL/TLS ，学会它们就能学会 HTTPS。



#### SSL/TLS

SSL 即**安全套接层**（`Secure Sockets Layer`），在 OSI 模型中处于第 5 层（会话层）。



SSL 到 v3 版本时证明了它自身是一个非常好的安全通信协议，于是互联网工程组 IETF 在 1999 年`把它改名为 TLS`（传输层安全，`Transport Layer Security`），正式标准化，版本号从 1.0 重新算起，所以  TLS1.0 实际上就是 SSLv3.1。

目前最广泛应用的是 TLS 1.2。

TSL 由**记录协议**、**握手协议**、**警告协议**、**变更密码规范协议**、**扩展协议**等几个子协议组成，综合使用了**对称加密**、**非对称加密**、**身份认证**等许多密码学前沿技术。



浏览器和服务器在使用 TLS 建立连接时**需要选择一组恰当的加密算法来实现安全通信**，这些算法的**组合**被称为“**密码套件**”（cipher suite，也叫加密套件）。



TLS 的密码套件命名非常规范，格式固定。

基本的形式是：*密钥交换算法+签名算法+对称加密算法+摘要算法*。



- `密钥交换算法` ，用于`握手`；
- `签名算法`，用于`签名和身份认证`，保证四大特性中的`身份认证`和`不可否认`；
- `对称加密算法`，用于握手后的`通信`，保证四大特性中的`机密性`；
- `摘要算法`，用于`消息认证`和`产生随机数`，保证四大特性中的`完整性`；



比如：`ECDHE-RSA-AES256-GCM-SHA384` 

可以拆分为:  ECDHE + RSA + AES256-GCM + SHA384，表示：

“握手时使用 ECDHE 算法进行密钥交换，用 RSA 签名和身份认证，握手后的通信使用 AES 对称算法，密钥长度 256 位，分组模式是 GCM，摘要算法 SHA384 用于消息认证和产生随机数。”



#### OpenSSL

一个著名的*开源*密码学程序库和工具包，几乎支持所有公开的加密算法和协议，已经成为了事实上的标准，许多应用软件都会使用它作为底层来实现 TLS 功能，包括常用的 Web 服务器 Apache、Nginx 等。

OpenSSL 还有其他分支，比如 Google 的 `BoringSSL`、OpenBSD 的 `LibreSSL`，在 OpenSSL 的基础上进行删减，新增了一些特性。





#### 小结 

1. 因为 HTTP 是明文传输，所以不安全，容易被黑客窃听或窜改；
2. 通信安全必须同时具备机密性、完整性，身份认证和不可否认这四个特性；
3. HTTPS 的语法、语义仍然是 HTTP，但把下层的协议由 TCP/IP 换成了 SSL/TLS；
4. SSL/TLS 是信息安全领域中的权威标准，采用多种先进的加密技术保证通信安全；
5. OpenSSL 是著名的开源密码学工具包，是 SSL/TLS 的具体实现；
6. HTTPS 用`加密手段`来实现`机密性`、用`接口签名`来实现`完整性`、用`数字签名`来实现`身份认证`。









