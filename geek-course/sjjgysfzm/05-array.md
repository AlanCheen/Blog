# 05 | 数组：为什么很多编程语言中数组都从0开始编号?

### 数组



数组（Array）是一种*线性表*数据结构。它用一组*连续的内存空间*，来存储一组具有*相同类型*的数据。



关键点：线性表、连续的内存空间、相同类型。



*线性表*，最多只有前和后两个方向：

- 数组
- 队列
- 栈
- 链表

![img](http://ww3.sinaimg.cn/large/006tNc79ly1g52j5z6iqzj30vq0n5acy.jpg)



非线性表：

- 树
- 图
- 堆

![img](http://ww2.sinaimg.cn/large/006tNc79ly1g52j91482zj30vq0k7q4w.jpg)



### 为什么从 0 开始编号呢？



从数组内存模型来看，数组的“下标”最确切的定义应该是“`偏移`”（offset）。

前面也讲到，如果用 a 来表示数组的首地址，a[0] 就是偏移为 0 的位置，也就是首地址，a[k] 就表示偏移 k 个 type_size 的位置，，所以计算 a[k] 的`内存地址`只需要用这个公式：

```
//从 0 开始
a[k]_address = base_address + k * type_size
//从 1 开始 (k-1)需要计算
a[k]_address = base_address + (k-1)*type_size
```

注：type_size 为类型的 size，比如 int 是 4 字节。



发现 index 从 1 开始的话，每次访问都会做一次减法计算，对于 CPU 来说就多一个减法指令，性能相对来说更差。



基础的数据结构性能要做到极致。



注：可能也是历史原因。



![img](http://ww3.sinaimg.cn/large/006tNc79ly1g52jstac99j30vq0g4jso.jpg)

内存块的首地址为 base_address = 1000。



### 数组的特点

- 支持随机访问;
- 删除、插入操作非常**低效**，因为要保证连续性，需要做大量数据搬移的工作，平均复杂度为 O(n);
- 数组**适合查找操作**，根据下标随机访问查找复杂度为O(1)，二分法查找（排好序）时间复杂度O(logn);
- 需要预先指定大小，不能扩容；



### 数组相对容器更适用的场景

比如 ArrayList。

1. 关注性能或者跟基本类型配合：ArrayList 无法存储基本类型，需要使用包装类，包装拆装有一定性能损耗；
2. 数据大小已知，且操作简单的情况，不是非得用容器；
3. 多维数组，`Object[][]`更加直观；